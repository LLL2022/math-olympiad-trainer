<!DOCTYPE html>
<html>
<head>
    <title>Math Olympiad Trainer</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://d3js.org/d3.v6.min.js"></script>
</head>
<body>
    <h1>Math Olympiad Trainer</h1>


    <!-- Random Problem generator-->
    <button id="generate-text">Random Problem</button>
    <p id="random-text"></p>

    <button id="generate-sol">Show Solution</button>
    <p id="sol-text"></p>

    <!-- Below is JS code for Random Problem function -->
    <script>
        $(document).ready(function() {
            var twoDArray;

            fetch('/test/problems_test.csv')
                .then(function(response) {
                    return response.text();
                })
                .then(function(data) {
                    // Parse the CSV data using the built-in CSV parser
                    var rows = data.trim().split('\n');
                    twoDArray = rows.map(function(row) {
                        return row.split(',');
                    });

                    // Now, twoDArray should contain all the entries from the CSV file
                    console.log(twoDArray);

                    var info;

                    // Add the button click event handler here
                    $('#generate-text').click(function() {
                        var randomrow = twoDArray[Math.floor(Math.random() * twoDArray.length)];
                        var randomText = randomrow.join(', ');

                        // JS splits based on commas, not semicolons
                        // We concatenate everything them split based on semicolons manually

                        info = randomText.split(";;");
                        let question = info.at(-2);

                        // For debugging purposes
                        console.log(randomrow);
                        console.log(randomText);
                        console.log(info);
                        console.log(question);


                        $('#random-text').html(question);
                        MathJax.typeset();
                        $('#sol-text').html("");
                    });

                    // To show solution
                    $('#generate-sol').click(function() {
                        let solution = info.at(-1);

                        $('#sol-text').html(solution);
                        MathJax.typeset();
                    });
                })
                .catch(function(error) {
                    console.error('Error reading CSV file:', error);
                });
        });
    </script>
    
</body>
</html>